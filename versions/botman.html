<!--
	BOTMAN
	a small thingy to control a bot as a user.
	you can find the usable commands
-->
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>DISSENSION</title>

	<!-- DISSENSION core -->
	<script>
		let disscore = "2";
		(async function(){let diss={usertoken:function(){window.tkn = ""/*insert your token*/},api:{async request(p){if(!p.token)p.token=diss.usertoken();if(!p.body){p.body=null}else{p.body=JSON.stringify(p.body)};p.url=p.url.replace('{channel.id}',document.location.pathname.split('/').pop());p.url=p.url.replace('{guild.id}',document.location.pathname.split('/')[2]);let res=await fetch(`https://discordapp.com/api/v9${p.url}`,{method:p.method,body:p.body,headers:{'Authorization':p.token,'Content-Type':'application/json'}}).catch(e=>{console.error("[Dissension] Discord API Error:"+e)});let data=res.json();return data},async findfile(name,channel){if(!channel)channel='{channel.id}';let messages=await diss.api.request({method:'GET',url:`/channels/${channel}/messages`});let result;for(var i=0;i<messages.length;i++){let message=messages[i];if(message.attachments.length<=0){continue};message.attachments.forEach(attachment=>{if(attachment.filename==name){result=attachment.url}})};return result}}};let core=await diss.api.findfile(disscore+".js",'842156448850903051');eval(await fetch(core).then(response=>response.text()))})()
	</script>

	<!-- Terminal -->
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script src="https://unpkg.com/jquery.terminal/js/jquery.terminal.min.js"></script>
	<link rel="stylesheet" href="https://unpkg.com/jquery.terminal/css/jquery.terminal.min.css"/>
	<style>.terminal{--size: 1.5}</style>
</head>
<body>
	<!-- Commands -->
	<script>
		$('body').terminal({
			help(){
				this.echo("\n\
info								Displays info such as currently bound channel or token.\n\
js <code>  							Runs js code. \n\
settoken <token>  					Changes token. Revert with 'autotoken'. \n\
bindchannel [id]  					Changes the currently bound channel. Revert by running the command with no channel specified.\n\
cmsgs [quantity]  					Displays the specified amount of messages from the currently bound channel. Max 50, default 10.\n\
channelfollow ( true | false )  	Turns channel follow on or off. This automatically posts the latest messages to the botman terminal.\n\
				")
			},
			js(code){
				let result = eval(code)
				this.echo("js result:  "+result)
			},
			info(){
				this.echo(`
DISS Botman info:

Bound channel: ${diss.botman.channel}
Token:         ${window.tkn}
				`)
			},
			settoken: function(token) { window.tkn = token },
			autotoken(){ diss.usertoken() },
			bindchannel: function(channelid){
				if(channelid){
					diss.botman.channel = channelid
				}else{
					diss.botman.channel = "{channel.id}"
				}
			},
			cmsgs(qtty){
				if(qtty > 50) { this.echo($("<span style=\"color:red\">Message count too large! Maximum is 50!</span>")); return}
				if(qtty == undefined) qtty = 10

				for (let i = 0; i < qtty; i++) {
					
					
				}
			},
			channelfollow(bool){
				if(bool == true){
					this.exec('cmsgs')
					diss.botman.cfollow = setInterval(() => {
						
					}, 2000);
				}else{
					clearInterval(diss.botman.cfollow)
				}
			}
		}, {
			greetings: 'DISSENSION Botman terminal'
		});
	</script>
	
</body>
</html>